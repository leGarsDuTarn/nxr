<!-- HERO cohérente avec la homepage -->
<section class="admin-dashboard banner-dashboard">
  <div class="container py-5">
    <h1 class="display-5 fw-bold mb-1">Bonjour <%= current_user.first_name %></h1>
    <p class="lead mb-0">Bienvenue sur votre tableau de bord administrateur</p>
  </div>
</section>

<%# Trainings %>
<section class="container my-5">
  <% has_trainings = @trainings.present? %>

  <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4">
    <h2 class="mb-0 text-start fs-2 fw-bold text-uppercase">
      <i class="far fa-hand-peace me-2"></i>Gestion des entraînements
    </h2>

    <% if has_trainings %>
      <div class="d-flex gap-2 flex-wrap">
        <%= link_to new_admin_training_path, class: "btn-nxr d-inline-flex align-items-center" do %>
          <i class="fas fa-plus me-2"></i> Créer un entraînement
        <% end %>

        <%= link_to admin_trainings_path, class: "btn-nxr-orange d-inline-flex align-items-center" do %>
          <i class="fas fa-list-ul me-2"></i> Voir tous les entraînements
        <% end %>
      </div>
    <% end %>
  </div>

  <% if has_trainings %>
    <div class="home-carousel" data-controller="carousel" data-carousel-step-value="item">
      <button type="button" class="home-carousel__nav home-carousel__nav--prev"
              data-action="click->carousel#prev" aria-label="Précédent">‹</button>
      <button type="button" class="home-carousel__nav home-carousel__nav--next"
              data-action="click->carousel#next" aria-label="Suivant">›</button>

      <div class="home-carousel__track" data-carousel-target="track">
        <% @trainings.each do |training| %>
          <div class="home-carousel__item">
            <article class="card card-admin shadow-sm rounded-4 h-100 overflow-hidden">
              <!-- Media -->
              <div class="ratio ratio-4x3 bg-dark">
                <% if training.image.attached? %>
                  <%= image_tag training.image, class: "card-img-top object-cover", alt: training.name %>
                <% else %>
                  <%= image_tag "training_img.png", class: "card-img-top object-contain p-3", alt: training.name %>
                <% end %>
              </div>

              <!-- Body -->
              <div class="card-body d-flex flex-column">
                <div class="d-flex align-items-start justify-content-between mb-2">
                  <h3 class="h6 fw-bold mb-0"><%= training.name %></h3>
                </div>

                <p class="text-tertiary small mb-3">
                  <i class="far fa-clock me-1"></i>
                  <%= l(training.date, format: "%d %B %Y") %>
                </p>

                <%# ----- Card Inscription avec barre de progres ------- %>
                <div class="mb-4 inscriptions-panel rounded-4 p-3">
                  <div class="d-flex align-items-center justify-content-between mb-2">
                    <h6 class="fw-bold mb-0">Inscriptions</h6>
                    <span class="badge-counter"><i class="far fa-user me-1"></i><%= training.registrations.size %></span>
                  </div>

                  <ul class="list-unstyled mb-3">
                    <li class="d-flex justify-content-between align-items-center py-1">
                      <span>En cours</span>
                      <span class="badge-pending-full-sm"><%= training.registrations.size - training.registrations.validated.size %></span>
                    </li>
                    <li class="d-flex justify-content-between align-items-center py-1">
                      <span>Validées</span>
                      <span class="badge-success-full-sm"><%= training.registrations.validated.size %></span>
                    </li>
                  </ul>

                  <% total = training.registrations.size.to_f
                     validated = training.registrations.validated.size
                     pct = total.positive? ? ((validated / total) * 100).round : 0 %>

                  <div class="inscriptions-progress">
                    <div class="progress" role="progressbar" aria-label="Taux de validations"
                         aria-valuenow="<%= pct %>" aria-valuemin="0" aria-valuemax="100">
                      <div class="progress-bar" style="width: <%= pct %>%"></div>
                    </div>
                    <small class="d-block mt-1"><%= pct %>% validées</small>
                  </div>
                </div>
                <%# ------- Fin de la card Inscription avec barre de progres ------- %>

                <div class="mt-auto d-flex align-items-center justify-content-between">
                  <%= link_to admin_training_path(training),
                        class: "stretched-link btn-nxr small" do %>
                    <i class="fas fa-search me-1"></i> Voir la fiche
                  <% end %>

                  <div class="btn-toolbar gap-2">
                    <%= link_to edit_admin_training_path(training),
                          class: "btn btn-icon btn-edit-orange",
                          title: "Modifier #{training.name}",
                          aria: { label: "Modifier l'événement #{training.name}" } do %>
                      <i class="fas fa-edit"></i>
                    <% end %>

                    <%= link_to admin_training_path(training),
                          data: { turbo_method: :delete, turbo_confirm: "Supprimer cet entraînement ?" },
                          class: "btn btn-icon btn-delete-red",
                          title: "Supprimer #{training.name}",
                          aria: { label: "Supprimer l'entraînement #{training.name}" } do %>
                      <i class="fas fa-trash"></i>
                    <% end %>
                  </div>
                </div>
              </div>
            </article>
          </div>
        <% end %>
      </div>
    </div>
  <% else %>
    <!-- Empty state -->
    <div class="card-homepage shadow-sm rounded-4 text-center p-5 mx-auto" style="max-width: 640px;">
      <div class="mb-3">
        <i class="far fa-calendar-times fa-3x"></i>
      </div>
      <h3 class="h5 fw-bold mb-2">Aucun entraînement pour le moment</h3>
      <p class="mb-4">Créez votre premier entraînement pour le club MCNC.</p>
      <%= link_to new_admin_training_path, class: "btn-nxr d-inline-flex align-items-center" do %>
        <i class="fas fa-plus me-2"></i>Créer un entraînement
      <% end %>
    </div>
  <% end %>
</section>

<%# Races %>
<section class="container my-5">
  <% has_races = @races.present? %>

  <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4">
    <h2 class="mb-0 text-start fs-2 fw-bold text-uppercase">
      <i class="fas fa-flag-checkered me-2"></i>Gestion des courses
    </h2>

    <% if has_races %>
      <div class="d-flex gap-2 flex-wrap">
        <%= link_to new_admin_race_path, class: "btn-nxr d-inline-flex align-items-center" do %>
          <i class="fas fa-plus me-2"></i> Créer une course
        <% end %>

        <%= link_to admin_races_path, class: "btn-nxr-orange d-inline-flex align-items-center" do %>
          <i class="fas fa-list-ul me-2"></i> Voir toutes les courses
        <% end %>
      </div>
    <% end %>
  </div>

  <% if has_races %>
    <div class="home-carousel" data-controller="carousel" data-carousel-step-value="item">
      <button type="button" class="home-carousel__nav home-carousel__nav--prev"
              data-action="click->carousel#prev" aria-label="Précédent">‹</button>
      <button type="button" class="home-carousel__nav home-carousel__nav--next"
              data-action="click->carousel#next" aria-label="Suivant">›</button>

      <div class="home-carousel__track" data-carousel-target="track">
        <% @races.each do |race| %>
          <div class="home-carousel__item">
            <article class="card card-admin shadow-sm rounded-4 h-100 overflow-hidden">
              <!-- Media -->
              <div class="ratio ratio-4x3 bg-dark">
                <% if race.image.attached? %>
                  <%= image_tag race.image, class: "card-img-top object-cover", alt: race.name %>
                <% else %>
                  <%= image_tag "race_flag.png", class: "card-img-top object-contain p-3", alt: race.name %>
                <% end %>
              </div>

              <!-- Body -->
              <div class="card-body d-flex flex-column">
                <div class="d-flex align-items-start justify-content-between mb-2">
                  <h3 class="h6 fw-bold mb-0"><%= race.name %></h3>
                </div>

                <p class="text-tertiary small mb-3">
                  <i class="far fa-clock me-1"></i>
                  <%= l(race.date, format: "%d %B %Y") %>
                </p>

                <%# ----- Card Inscription avec barre de progres ------- %>
                <div class="mb-4 inscriptions-panel rounded-4 p-3">
                  <div class="d-flex align-items-center justify-content-between mb-2">
                    <h6 class="fw-bold mb-0">Inscriptions</h6>
                    <span class="badge-counter"><i class="far fa-user me-1"></i><%= race.registrations.size %></span>
                  </div>

                  <ul class="list-unstyled mb-3">
                    <li class="d-flex justify-content-between align-items-center py-1">
                      <span>En cours</span>
                      <span class="badge-pending-full-sm"><%= race.registrations.size - race.registrations.validated.size %></span>
                    </li>
                    <li class="d-flex justify-content-between align-items-center py-1">
                      <span>Validées</span>
                      <span class="badge-success-full-sm"><%= race.registrations.validated.size %></span>
                    </li>
                  </ul>

                  <% total = race.registrations.size.to_f
                     validated = race.registrations.validated.size
                     pct = total.positive? ? ((validated / total) * 100).round : 0 %>

                  <div class="inscriptions-progress">
                    <div class="progress" role="progressbar" aria-label="Taux de validations"
                         aria-valuenow="<%= pct %>" aria-valuemin="0" aria-valuemax="100">
                      <div class="progress-bar" style="width: <%= pct %>%"></div>
                    </div>
                    <small class="d-block mt-1"><%= pct %>% validées</small>
                  </div>
                </div>
                <%# ------- Fin de la card Inscription avec barre de progres ------- %>

                <div class="d-flex align-items-center justify-content-between">
                  <%= link_to admin_race_path(race),
                        class: "stretched-link btn-nxr small" do %>
                    <i class="fas fa-search me-1"></i> Voir la fiche
                  <% end %>

                  <div class="btn-toolbar gap-2">
                    <%= link_to edit_admin_race_path(race),
                          class: "btn btn-icon btn-edit-orange",
                          title: "Modifier #{race.name}",
                          aria: { label: "Modifier la course #{race.name}" } do %>
                      <i class="fas fa-edit"></i>
                    <% end %>

                    <%= link_to admin_race_path(race),
                          data: { turbo_method: :delete, turbo_confirm: "Supprimer cette course ?" },
                          class: "btn btn-icon btn-delete-red",
                          title: "Supprimer #{race.name}",
                          aria: { label: "Supprimer la course #{race.name}" } do %>
                      <i class="fas fa-trash"></i>
                    <% end %>
                  </div>
                </div>
              </div>
            </article>
          </div>
        <% end %>
      </div>
    </div>
  <% else %>
    <!-- Empty state -->
    <div class="card-homepage shadow-sm rounded-4 text-center p-5 mx-auto" style="max-width: 640px;">
      <div class="mb-3">
        <i class="far fa-calendar-times fa-3x"></i>
      </div>
      <h3 class="h5 fw-bold mb-2">Aucune course pour le moment</h3>
      <p class="mb-4">Créez votre première course pour le club MCNC.</p>
      <%= link_to new_admin_race_path, class: "btn-nxr d-inline-flex align-items-center" do %>
        <i class="fas fa-plus me-2"></i>Créer une course
      <% end %>
    </div>
  <% end %>
</section>

<%# Events %>
<section class="container my-5">
  <% has_events = @events.present? %>

  <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4">
    <h2 class="mb-0 text-start fs-2 fw-bold text-uppercase">
      <i class="fas fa-calendar-alt me-2"></i>Gestion des événements
    </h2>

    <% if has_events %>
      <div class="d-flex gap-2 flex-wrap">
        <%= link_to new_admin_event_path, class: "btn-nxr d-inline-flex align-items-center" do %>
          <i class="fas fa-plus me-2"></i> Créer un événement
        <% end %>

        <%= link_to admin_events_path, class: "btn-nxr-orange d-inline-flex align-items-center" do %>
          <i class="fas fa-list-ul me-2"></i> Voir tous les événements
        <% end %>
      </div>
    <% end %>
  </div>

  <% if has_events %>
    <div class="home-carousel" data-controller="carousel" data-carousel-step-value="item">
      <button type="button" class="home-carousel__nav home-carousel__nav--prev"
              data-action="click->carousel#prev" aria-label="Précédent">‹</button>
      <button type="button" class="home-carousel__nav home-carousel__nav--next"
              data-action="click->carousel#next" aria-label="Suivant">›</button>

      <div class="home-carousel__track" data-carousel-target="track">
        <% @events.each do |event| %>
          <div class="home-carousel__item">
            <article class="card card-admin shadow-sm rounded-4 h-100 overflow-hidden">
              <!-- Media -->
              <div class="ratio ratio-4x3 bg-dark">
                <% if event.image.attached? %>
                  <%= image_tag event.image, class: "card-img-top object-cover", alt: event.name %>
                <% else %>
                  <%= image_tag "logo_mcnc_3.png", class: "card-img-top object-contain p-3", alt: event.name %>
                <% end %>
              </div>

              <!-- Body -->
              <div class="card-body d-flex flex-column">
                <div class="d-flex align-items-start justify-content-between mb-2">
                  <h5 class="fw-bold mb-0"><%= event.name %></h5>
                </div>

                <p class="text-tertiary small mb-3">
                  <i class="far fa-clock me-1"></i>
                  <%= l(event.date, format: "%d %B %Y") %>
                </p>

                <%# ----- Card Inscription avec barre de progres ------- %>
                <div class="mb-4 inscriptions-panel rounded-4 p-3">
                  <div class="d-flex align-items-center justify-content-between mb-2">
                    <h6 class="fw-bold mb-0">Inscriptions</h6>
                    <span class="badge-counter"><i class="far fa-user me-1"></i><%= event.registrations.size %></span>
                  </div>

                  <ul class="list-unstyled mb-3">
                    <li class="d-flex justify-content-between align-items-center py-1">
                      <span>En cours</span>
                      <span class="badge-pending-full-sm"><%= event.registrations.size - event.registrations.validated.size %></span>
                    </li>
                    <li class="d-flex justify-content-between align-items-center py-1">
                      <span>Validées</span>
                      <span class="badge-success-full-sm"><%= event.registrations.validated.size %></span>
                    </li>
                  </ul>

                  <% total = event.registrations.size.to_f
                     validated = event.registrations.validated.size
                     pct = total.positive? ? ((validated / total) * 100).round : 0 %>

                  <div class="inscriptions-progress">
                    <div class="progress" role="progressbar" aria-label="Taux de validations"
                         aria-valuenow="<%= pct %>" aria-valuemin="0" aria-valuemax="100">
                      <div class="progress-bar" style="width: <%= pct %>%"></div>
                    </div>
                    <small class="d-block mt-1"><%= pct %>% validées</small>
                  </div>
                </div>
                <%# ------- Fin de la card Inscription avec barre de progres ------- %>

                <div class="mt-auto d-flex align-items-center justify-content-between">
                  <%= link_to admin_event_path(event),
                        class: "stretched-link stretched-link btn-nxr small" do %>
                    <i class="fas fa-search me-1"></i> Voir la fiche
                  <% end %>

                  <div class="btn-toolbar gap-2">
                    <%= link_to edit_admin_event_path(event),
                          class: "btn btn-icon btn-edit-orange",
                          title: "Modifier #{event.name}",
                          aria: { label: "Modifier l'événement #{event.name}" } do %>
                      <i class="fas fa-edit"></i>
                    <% end %>

                    <%= link_to admin_event_path(event),
                          data: { turbo_method: :delete, turbo_confirm: "Supprimer cet événement ?" },
                          class: "btn btn-icon btn-delete-red",
                          title: "Supprimer #{event.name}",
                          aria: { label: "Supprimer l'événement #{event.name}" } do %>
                      <i class="fas fa-trash"></i>
                    <% end %>
                  </div>
                </div>
              </div>
            </article>
          </div>
        <% end %>
      </div>
    </div>
  <% else %>
    <!-- Empty state -->
    <div class="card-homepage shadow-sm rounded-4 text-center p-5 mx-auto" style="max-width: 640px;">
      <div class="mb-3">
        <i class="far fa-calendar-times fa-3x"></i>
      </div>
      <h3 class="h5 fw-bold mb-2">Aucun événement pour le moment</h3>
      <p class="mb-4">Créez votre premier événement pour le club MCNC.</p>
      <%= link_to new_admin_event_path, class: "btn-nxr d-inline-flex align-items-center" do %>
        <i class="fas fa-plus me-2"></i>Créer un événement
      <% end %>
    </div>
  <% end %>
</section>

<%# Registrations %>
<section class="container my-5">
  <% has_registrations = @recent_registrations.present? %>

  <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4">
    <h2 class="mb-0 text-start fs-2 fw-bold text-uppercase">
      <i class="fas fa-user-plus me-2"></i>Les dernières inscriptions
    </h2>
  </div>

  <% if has_registrations %>
    <div class="home-carousel" data-controller="carousel" data-carousel-step-value="item">
      <button type="button" class="home-carousel__nav home-carousel__nav--prev"
              data-action="click->carousel#prev" aria-label="Précédent">‹</button>
      <button type="button" class="home-carousel__nav home-carousel__nav--next"
              data-action="click->carousel#next" aria-label="Suivant">›</button>

      <div class="home-carousel__track" data-carousel-target="track">
        <% @recent_registrations.each do |registration| %>
          <% user = registration.user %>
          <div class="home-carousel__item">
            <article class="card card-admin shadow-sm rounded-4 h-100 overflow-hidden">
              <!-- Media -->
              <div class="ratio ratio-4x3 bg-dark">
                <% if user.respond_to?(:avatar) && user.avatar.attached? %>
                  <%= image_tag user.avatar, class: "card-img-top object-cover", alt: "#{user.first_name} #{user.last_name}" %>
                <% else %>
                  <%= image_tag "avatar_default.jpg", class: "card-img-top object-contain p-3", alt: "#{user.first_name} #{user.last_name}" %>
                <% end %>
              </div>

              <!-- Body -->
              <div class="card-body d-flex flex-column">
                <div class="d-flex align-items-start justify-content-between mb-2">
                  <h3 class="h6 fw-bold mb-0"><%= user.first_name %> <%= user.last_name %></h3>
                </div>

                <p class="text-tertiary small mb-2">
                  <i class="far fa-id-card me-1"></i>
                  Inscription à
                  <strong><%= registration.registerable.try(:name) || registration.registerable_type %></strong>
                  le <%= l(registration.created_at, format: :short) %>
                </p>

                <p class="text-tertiary small mb-3">
                  <i class="far fa-user me-1"></i>
                  Membre depuis le <%= l(user.created_at.to_date, format: "%d %B %Y") %>
                  <small class="text-tertiary">(<%= time_ago_in_words(user.created_at) %>)</small>
                </p>

                <div class="mt-auto d-flex align-items-center justify-content-between">
                  <%= link_to polymorphic_path([:admin, registration.registerable, registration]),
                        class: "stretched-link btn-nxr small" do %>
                    <i class="fas fa-search me-1"></i> Voir la fiche
                  <% end %>

                  <div class="btn-toolbar gap-2">
                    <%= link_to polymorphic_path([:admin, registration.registerable, registration]),
                          class: "btn btn-icon btn-edit-orange",
                          title: "Voir l'inscription de #{user.first_name} #{user.last_name}",
                          aria: { label: "Voir l'inscription de #{user.first_name} #{user.last_name}" } do %>
                      <i class="fas fa-search"></i>
                    <% end %>

                    <%= link_to polymorphic_path([:admin, registration.registerable, registration]),
                          data: { turbo_method: :delete, turbo_confirm: "Supprimer cette inscription ?" },
                          class: "btn btn-icon btn-delete-red",
                          title: "Supprimer l'inscription de #{user.first_name} #{user.last_name}",
                          aria: { label: "Supprimer l'inscription de #{user.first_name} #{user.last_name}" } do %>
                      <i class="fas fa-trash"></i>
                    <% end %>
                  </div>
                </div>
              </div>
            </article>
          </div>
        <% end %>
      </div>
    </div>
  <% else %>
    <!-- Empty state -->
    <div class="card-homepage shadow-sm rounded-4 text-center p-5 mx-auto" style="max-width: 640px;">
      <div class="mb-3">
        <i class="far fa-clipboard fa-3x"></i>
      </div>
      <h3 class="h5 fw-bold mb-2">Aucune inscription récente</h3>
      <p class="mb-0">Les nouvelles inscriptions apparaîtront ici.</p>
    </div>
  <% end %>
</section>

<%# Les News (Articles) %>
<section class="container my-5">
  <% has_articles = @articles.present? %>

  <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4">
    <h2 class="mb-0 text-start fs-2 fw-bold text-uppercase">
      <i class="fas fa-newspaper me-2"></i>Gestion des articles
    </h2>

    <% if has_articles %>
      <div class="d-flex gap-2 flex-wrap">
        <%= link_to new_admin_article_path, class: "btn-nxr d-inline-flex align-items-center" do %>
          <i class="fas fa-plus me-2"></i> Créer un article
        <% end %>

        <%= link_to admin_articles_path, class: "btn-nxr-orange d-inline-flex align-items-center" do %>
          <i class="fas fa-list-ul me-2"></i> Voir tous les articles
        <% end %>
      </div>
    <% end %>
  </div>

  <% if has_articles %>
    <div class="home-carousel" data-controller="carousel" data-carousel-step-value="item">
      <button type="button" class="home-carousel__nav home-carousel__nav--prev"
              data-action="click->carousel#prev" aria-label="Précédent">‹</button>
      <button type="button" class="home-carousel__nav home-carousel__nav--next"
              data-action="click->carousel#next" aria-label="Suivant">›</button>

      <div class="home-carousel__track" data-carousel-target="track">
        <% @articles.each do |article| %>
          <div class="home-carousel__item">
            <article class="card card-admin shadow-sm rounded-4 h-100 overflow-hidden">
              <!-- Media -->
              <div class="ratio ratio-4x3 bg-dark">
                <% if article.image.attached? %>
                  <%= image_tag article.image, class: "card-img-top object-cover", alt: article.title %>
                <% else %>
                  <%= image_tag "logo_mcnc_3.png", class: "card-img-top object-contain p-3", alt: article.title %>
                <% end %>
              </div>

              <!-- Body -->
              <div class="card-body d-flex flex-column">
                <div class="d-flex align-items-start justify-content-between mb-2">
                  <h3 class="h6 fw-bold mb-0"><%= article.title %></h3>
                </div>

                <p class="text-tertiary small mb-3">
                  <i class="far fa-clock me-1"></i>
                  <%= l(article.date, format: "%d %B %Y") %>
                </p>

                <div class="mt-auto d-flex align-items-center justify-content-between">
                  <%= link_to admin_article_path(article),
                        class: "stretched-link btn-nxr small" do %>
                    <i class="fas fa-search me-1"></i> Voir l'article
                  <% end %>

                  <div class="btn-toolbar gap-2">
                    <%= link_to edit_admin_article_path(article),
                          class: "btn btn-icon btn-edit-orange",
                          title: "Modifier #{article.title}",
                          aria: { label: "Modifier l'article' #{article.title}" } do %>
                      <i class="fas fa-edit"></i>
                    <% end %>

                    <%= link_to admin_article_path(article),
                          data: { turbo_method: :delete, turbo_confirm: "Supprimer cet article ?" },
                          class: "btn btn-icon btn-delete-red",
                          title: "Supprimer #{article.title}",
                          aria: { label: "Supprimer l'article' #{article.title}" } do %>
                      <i class="fas fa-trash"></i>
                    <% end %>
                  </div>
                </div>
              </div>
            </article>
          </div>
        <% end %>
      </div>
    </div>
  <% else %>
    <!-- Empty state -->
    <div class="card-homepage shadow-sm rounded-4 text-center p-5 mx-auto" style="max-width: 640px;">
      <div class="mb-3">
        <i class="far fa-calendar-times fa-3x"></i>
      </div>
      <h3 class="h5 fw-bold mb-2">Aucun article pour le moment</h3>
      <p class="mb-4">Créez votre premier article pour le club MCNC.</p>
      <%= link_to new_admin_article_path, class: "btn-nxr d-inline-flex align-items-center" do %>
        <i class="fas fa-plus me-2"></i>Créer un article
      <% end %>
    </div>
  <% end %>
</section>

<%# Galleries %>
<section class="container my-5">
  <% has_galleries = @galleries.present? %>

  <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4">
    <h2 class="mb-0 text-start fs-2 fw-bold text-uppercase">
      <i class="fas fa-camera-retro me-2"></i>Gestion des albums photo
    </h2>

    <% if has_galleries %>
      <div class="d-flex gap-2 flex-wrap">
        <%= link_to new_admin_gallery_path, class: "btn-nxr d-inline-flex align-items-center" do %>
          <i class="fas fa-plus me-2"></i> Créer un nouvel album
        <% end %>

        <%= link_to admin_galleries_path, class: "btn-nxr-orange d-inline-flex align-items-center" do %>
          <i class="fas fa-list-ul me-2"></i> Voir tous les albums
        <% end %>
      </div>
    <% end %>
  </div>

  <% if has_galleries %>
    <div class="home-carousel" data-controller="carousel" data-carousel-step-value="item">
      <button type="button" class="home-carousel__nav home-carousel__nav--prev"
              data-action="click->carousel#prev" aria-label="Précédent">‹</button>
      <button type="button" class="home-carousel__nav home-carousel__nav--next"
              data-action="click->carousel#next" aria-label="Suivant">›</button>

      <div class="home-carousel__track" data-carousel-target="track">
        <% @galleries.each do |gallery| %>
          <div class="home-carousel__item">
            <article class="card card-admin shadow-sm rounded-4 h-100 overflow-hidden">
              <!-- Media -->
              <div class="ratio ratio-4x3 bg-dark">
                <% if gallery.images.attached? %>
                  <%= image_tag gallery.images.first, class: "card-img-top object-cover", alt: gallery.title %>
                <% else %>
                  <%= image_tag "logo_mcnc_3.png", class: "card-img-top object-contain p-3", alt: gallery.title %>
                <% end %>
              </div>

              <!-- Body -->
              <div class="card-body d-flex flex-column">
                <div class="d-flex align-items-start justify-content-between mb-2">
                  <h3 class="h6 fw-bold mb-0"><%= gallery.title %></h3>
                </div>

                <p class="text-tertiary small mb-3">
                  <i class="far fa-clock me-1"></i>
                  <%= l(gallery.date, format: "%d %B %Y") %>
                </p>

                <div class="mt-auto d-flex align-items-center justify-content-between">
                  <%= link_to admin_gallery_path(gallery),
                        class: "stretched-link btn-nxr small" do %>
                    <i class="fas fa-search me-1"></i> Voir l'album
                  <% end %>

                  <div class="btn-toolbar gap-2">
                    <%= link_to edit_admin_gallery_path(gallery),
                          class: "btn btn-icon btn-edit-orange",
                          title: "Modifier #{gallery.title}",
                          aria: { label: "Modifier l'album photo' #{gallery.title}" } do %>
                      <i class="fas fa-edit"></i>
                    <% end %>

                    <%= link_to admin_gallery_path(gallery),
                          data: { turbo_method: :delete, turbo_confirm: "Supprimer cet album photo ?" },
                          class: "btn btn-icon btn-delete-red",
                          title: "Supprimer #{gallery.title}",
                          aria: { label: "Supprimer l'album photo' #{gallery.title}" } do %>
                      <i class="fas fa-trash"></i>
                    <% end %>
                  </div>
                </div>
              </div>
            </article>
          </div>
        <% end %>
      </div>
    </div>
  <% else %>
    <!-- Empty state -->
    <div class="card-homepage shadow-sm rounded-4 text-center p-5 mx-auto" style="max-width: 640px;">
      <div class="mb-3">
        <i class="far fa-calendar-times fa-3x"></i>
      </div>
      <h3 class="h5 fw-bold mb-2">Aucun album photo pour le moment</h3>
      <p class="mb-4">Créez votre premier album photo pour le club MCNC.</p>
      <%= link_to new_admin_gallery_path, class: "btn-nxr d-inline-flex align-items-center" do %>
        <i class="fas fa-plus me-2"></i>Créer un album photo
      <% end %>
    </div>
  <% end %>
</section>

<%# Users -> Member %>
<section class="container my-5">
  <% has_members = @users.present? %>

  <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4">
    <h2 class="mb-0 text-start fs-2 fw-bold text-uppercase">
      <i class="fas fa-users me-2"></i>Gestion des membres
    </h2>

    <% if has_members %>
      <div class="d-flex flex-wrap">
        <%= link_to admin_users_path, class: "btn-nxr-orange d-inline-flex align-items-center" do %>
          <i class="fas fa-list-ul me-2"></i> Voir tous les membres
        <% end %>
      </div>
    <% end %>
  </div>

  <% if has_members %>
    <div class="home-carousel" data-controller="carousel" data-carousel-step-value="item">
      <button type="button" class="home-carousel__nav home-carousel__nav--prev"
              data-action="click->carousel#prev" aria-label="Précédent">‹</button>
      <button type="button" class="home-carousel__nav home-carousel__nav--next"
              data-action="click->carousel#next" aria-label="Suivant">›</button>

      <div class="home-carousel__track" data-carousel-target="track">
        <% @users.each do |user| %>
          <div class="home-carousel__item">
            <article class="card card-admin shadow-sm rounded-4 h-100 overflow-hidden">
              <!-- Media -->
              <div class="ratio ratio-4x3 bg-dark">
                <% if user.avatar.attached? %>
                  <%= image_tag user.avatar, class: "card-img-top object-cover", alt: user.user_name %>
                <% else %>
                  <%= image_tag "avatar_default.jpg", class: "card-img-top object-contain p-3", alt: user.user_name %>
                <% end %>
              </div>

              <!-- Body -->
              <div class="card-body d-flex flex-column">
                <div class="d-flex align-items-start justify-content-between mb-2">
                  <h3 class="h6 fw-bold mb-0"><%= user.first_name %>  <%= user.last_name %></h3>
                </div>

                <p class="text-tertiary small mb-3">
                  <i class="far fa-user me-1"></i>
                  Membre depuis le <%= l(user.created_at.to_date, format: "%d %B %Y") %>
                  <small class="text-tertiary">(<%= time_ago_in_words(user.created_at) %>)</small>
                </p>

                <div class="mt-auto d-flex align-items-center justify-content-between">
                  <%= link_to admin_user_path(user),
                        class: "stretched-link btn-nxr small" do %>
                    <i class="fas fa-search me-1"></i> Voir la fiche
                  <% end %>

                  <div class="btn-toolbar gap-2">
                    <%= link_to edit_admin_user_path(user),
                          class: "btn btn-icon btn-edit-orange",
                          title: "Modifier les données de #{user.first_name} - #{user.last_name}" ,
                          aria: { label: "Modifier les données de #{user.first_name} - #{user.last_name}" } do %>
                      <i class="fas fa-edit"></i>
                    <% end %>

                    <%= link_to admin_user_path(user),
                          data: { turbo_method: :delete, turbo_confirm: "Supprimer cet utilisateur ?" },
                          class: "btn btn-icon btn-delete-red",
                          title: "Supprimer l'utilisateur #{user.first_name} - #{user.last_name}",
                          aria: { label: "Supprimer l'utilisateur #{user.first_name} - #{user.last_name}" } do %>
                      <i class="fas fa-trash"></i>
                    <% end %>
                  </div>
                </div>
              </div>
            </article>
          </div>
        <% end %>
      </div>
    </div>
  <% else %>
    <!-- Empty state -->
    <div class="card-homepage shadow-sm rounded-4 text-center p-5 mx-auto" style="max-width: 640px;">
      <div class="mb-3">
        <i class="far fa-calendar-times fa-3x"></i>
      </div>
      <h3 class="h5 fw-bold mb-2">Aucun membre inscrit pour le moment</h3>
      <p class="mb-4">Patience, les membres sont en route... montés sur des licornes.</p>
      <% end %>
    </div>
</section>

<%# ================================
    Club identity + Legal documents
    ================================ %>
<section class="container my-5">
  <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4">
    <h2 class="mb-0 text-start fs-2 fw-bold text-uppercase">
      <i class="fa-solid fa-screwdriver-wrench me-2"></i> Administration du club
    </h2>
  </div>

  <% has_club    = @club.present? %>
  <% has_privacy = @privacy_policy.present? %>
  <% has_legal   = @legal_notice.present? %>

  <div class="home-carousel" data-controller="carousel" data-carousel-step-value="item">
    <button type="button" class="home-carousel__nav home-carousel__nav--prev"
            data-action="click->carousel#prev" aria-label="Précédent">‹</button>
    <button type="button" class="home-carousel__nav home-carousel__nav--next"
            data-action="click->carousel#next" aria-label="Suivant">›</button>

    <div class="home-carousel__track" data-carousel-target="track">
      <!-- ITEM 1 : Club -->
      <div class="home-carousel__item">
        <article class="card card-admin shadow-sm rounded-4 h-100 overflow-hidden">
          <div class="ratio ratio-4x3 bg-dark">
            <% if has_club && @club.logo.attached? %>
              <%= image_tag @club.logo, class: "card-img-top object-contain p-3", alt: (@club&.name || "Club") %>
            <% else %>
              <%= image_tag "logo_mcnc_3.png", class: "card-img-top object-contain p-3", alt: "Club" %>
            <% end %>
          </div>

          <div class="card-body d-flex flex-column">
            <div class="d-flex align-items-start justify-content-between mb-2">
              <h3 class="h6 fw-bold mb-0">Fiche du club</h3>
            </div>

            <% if has_club %>
               <p class="text-tertiary small mb-2">
                <i class="fa-solid fa-id-badge me-1"></i>
                <strong><%= @club.name %></strong>
              </p>

              <p class="text-tertiary small mb-2">
                <i class="fas fa-id-card me-1"></i>
                N° d'affiliation : <strong><%= @club.affiliation_number %></strong>
              </p>

              <% if @club.phone_number.present? %>
                <p class="text-tertiary small mb-2">
                  <i class="fas fa-phone me-1"></i> <%= @club.phone_number %>
                </p>
              <% end %>

              <% if @club.email.present? %>
                <p class="text-tertiary small mb-3">
                  <i class="fas fa-envelope me-1"></i> <%= mail_to @club.email %>
                </p>
              <% end %>
            <% else %>
              <p class="text-tertiary small mb-3">Aucune information de club pour l'instant.</p>
            <% end %>

            <div class="mt-auto d-flex align-items-center justify-content-between">
              <% if has_club %>
                <%= link_to admin_club_path, class: "stretched-link btn-nxr small" do %>
                  <i class="fa-solid fa-gear me-1"></i> Administrer
                <% end %>

                <div class="btn-toolbar gap-2">
                  <%= link_to edit_admin_club_path, class: "btn btn-icon btn-edit-orange",
                              title: "Modifier le club", aria: { label: "Modifier le club" } do %>
                    <i class="fas fa-edit"></i>
                  <% end %>
                </div>
              <% else %>
                <%= link_to new_admin_club_path, class: "btn-nxr d-inline-flex align-items-center" do %>
                  <i class="fas fa-plus me-2"></i> Créer la fiche du club
                <% end %>
              <% end %>
            </div>
          </div>
        </article>
      </div>

      <!-- ITEM 2 : Privacy Policy -->
      <div class="home-carousel__item">
        <article class="card card-admin shadow-sm rounded-4 h-100 overflow-hidden">
          <div class="ratio ratio-4x3 bg-dark">
            <% if has_privacy && @privacy_policy.respond_to?(:image) && @privacy_policy.image.attached? %>
              <%= image_tag @privacy_policy.image, class: "card-img-top object-contain p-3", alt: (@privacy_policy.title.presence || "Politique de confidentialité") %>
            <% else %>
              <%= image_tag "RGPD.png", class: "card-img-top object-contain p-3", alt: "Politique de confidentialité" %>
            <% end %>
          </div>

          <div class="card-body d-flex flex-column">
            <div class="d-flex align-items-start justify-content-between mb-2">
              <h3 class="h6 fw-bold mb-0"><%= has_privacy ? @privacy_policy.title : "Politique de confidentialité" %></h3>
            </div>

            <% if has_privacy && @privacy_policy.published_at.present? %>
              <p class="text-tertiary small mb-3">
                <i class="far fa-clock me-1"></i>
                Dernière mise à jour : <%= l(@privacy_policy.published_at, format: :long) %>
              </p>
            <% else %>
              <p class="text-tertiary small mb-3">
                <i class="far fa-clock me-1"></i>
                Aucune politique de confidentialité pour l'instant.
              </p>
            <% end %>

            <div class="mt-auto d-flex align-items-center justify-content-between">
              <% if has_privacy %>
                <%= link_to admin_privacy_policy_path, class: "stretched-link btn-nxr small" do %>
                  <i class="fa-solid fa-gear me-1"></i> Administrer
                <% end %>

                <div class="btn-toolbar gap-2">
                  <%= link_to edit_admin_privacy_policy_path, class: "btn btn-icon btn-edit-orange",
                              title: "Modifier la politique de confidentialité",
                              aria: { label: "Modifier la politique de confidentialité" } do %>
                    <i class="fas fa-edit"></i>
                  <% end %>
                </div>
              <% else %>
                <%= link_to new_admin_privacy_policy_path, class: "btn-nxr d-inline-flex align-items-center" do %>
                  <i class="fas fa-plus me-2"></i> Créer
                <% end %>
              <% end %>
            </div>
          </div>
        </article>
      </div>

      <!-- ITEM 3 : Legal Notice -->
      <div class="home-carousel__item">
        <article class="card card-admin shadow-sm rounded-4 h-100 overflow-hidden">
          <div class="ratio ratio-4x3 bg-dark">
            <% if has_legal && @legal_notice.respond_to?(:image) && @legal_notice.image.attached? %>
              <%= image_tag @legal_notice.image, class: "card-img-top object-contain p-3", alt: (@legal_notice.title.presence || "Mentions légales") %>
            <% else %>
              <%= image_tag "RGPD.png", class: "card-img-top object-contain p-3", alt: "Mentions légales" %>
            <% end %>
          </div>

          <div class="card-body d-flex flex-column">
            <div class="d-flex align-items-start justify-content-between mb-2">
              <h3 class="h6 fw-bold mb-0"><%= has_legal ? @legal_notice.title : "Mentions légales" %></h3>
            </div>

            <% if has_legal && @legal_notice.published_at.present? %>
              <p class="text-tertiary small mb-3">
                <i class="far fa-clock me-1"></i>
                Dernière mise à jour : <%= l(@legal_notice.published_at, format: :long) %>
              </p>
            <% else %>
              <p class="text-tertiary small mb-3">
                <i class="far fa-clock me-1"></i>
                Aucunes mentions légales pour l'instant.
              </p>
            <% end %>

            <div class="mt-auto d-flex align-items-center justify-content-between">
              <% if has_legal %>
                <%= link_to admin_legal_notice_path, class: "stretched-link btn-nxr small" do %>
                  <i class="fa-solid fa-gear me-1"></i> Administrer
                <% end %>

                <div class="btn-toolbar gap-2">
                  <%= link_to edit_admin_legal_notice_path, class: "btn btn-icon btn-edit-orange",
                              title: "Modifier les mentions légales",
                              aria: { label: "Modifier les mentions légales" } do %>
                    <i class="fas fa-edit"></i>
                  <% end %>
                </div>
              <% else %>
                <%= link_to new_admin_legal_notice_path, class: "btn-nxr d-inline-flex align-items-center" do %>
                  <i class="fas fa-plus me-2"></i> Créer
                <% end %>
              <% end %>
            </div>
          </div>
        </article>
      </div>

    </div> <!-- /.home-carousel__track -->
  </div>   <!-- /.home-carousel -->
</section>
