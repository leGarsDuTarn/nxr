<!-- HERO cohérente avec la homepage -->
<section class="admin-hero banner-dashboard"
  style="background-image: linear-gradient(rgba(0,0,0,0.45), rgba(0,0,0,0.55)), url(<%= asset_path('banner_mcnc.jpeg') %>);">
  <div class="container py-5">
    <h1 class="display-5 fw-bold mb-1">Bonjour <%= current_user.first_name %></h1>
    <p class="lead mb-0">Bienvenue sur votre tableau de bord <strong>administrateur</strong></p>
  </div>
</section>

<section class="container my-5">
  <% has_events = @events.present? %>


  <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4">
    <h2 class="section-title mb-0">
      <i class="fas fa-calendar-alt me-2"></i>Gestion des événements
    </h2>

      <% if has_events %>
        <div class="d-flex gap-2 flex-wrap">
          <%= link_to new_admin_event_path, class: "btn-nxr d-inline-flex align-items-center" do %>
            <i class="fas fa-plus me-2"></i> Créer un événement
          <% end %>

          <%= link_to admin_events_path, class: "btn-nxr-orange d-inline-flex align-items-center" do %>
          <i class="fas fa-list-ul me-2"></i> Voir tous les événements
          <% end %>
        </div>
      <% end %>
    </div>



  <% if has_events %>
    <div class="row g-4">
      <% @events.each do |event| %>
        <div class="col-sm-6 col-lg-4 mx-auto">
          <article class="card card-admin shadow-sm rounded-4 h-100 overflow-hidden">
            <!-- Media -->
            <div class="ratio ratio-4x3 bg-dark">
              <% if event.image.attached? %>
                <%= image_tag event.image, class: "card-img-top object-cover", alt: event.name %>
              <% else %>
                <%= image_tag "logo_mcnc_3.png", class: "card-img-top object-contain p-3", alt: event.name %>
              <% end %>
            </div>

            <!-- Body -->
            <div class="card-body d-flex flex-column">
              <div class="d-flex align-items-start justify-content-between mb-2">
                <h3 class="h6 fw-bold mb-0"><%= event.name %></h3>
                <% if event.respond_to?(:status) %>
                  <span class="badge rounded-pill <%= event.status == "published" ? "bg-success" : "bg-secondary" %>">
                    <%= event.status.capitalize %>
                  </span>
                <% end %>
              </div>

              <p class="text-tertiary small mb-3">
                <i class="far fa-clock me-1"></i>
                <%= l(event.date, format: "%d %B %Y") %>
              </p>

              <div class="mt-auto d-flex align-items-center justify-content-between">
                <%= link_to admin_event_path(event),
                      class: "stretched-link text-decoration-none text-color-primary small me-2" do %>
                  <i class="fas fa-arrow-right me-1"></i> Voir la fiche
                <% end %>

                <div class="btn-toolbar gap-2">
                  <%= link_to edit_admin_event_path(event),
                        class: "btn btn-icon btn-edit-orange",
                        title: "Modifier #{event.name}",
                        aria: { label: "Modifier l'événement #{event.name}" } do %>
                    <i class="fas fa-edit"></i>
                  <% end %>

                  <%= link_to admin_event_path(event),
                        data: { turbo_method: :delete, turbo_confirm: "Supprimer cet événement ?" },
                        class: "btn btn-icon btn-delete-red",
                        title: "Supprimer #{event.name}",
                        aria: { label: "Supprimer l'événement #{event.name}" } do %>
                    <i class="fas fa-trash"></i>
                  <% end %>
                </div>
              </div>
            </div>
          </article>
        </div>
      <% end %>
    </div>


  <% else %>
    <!-- Empty state -->
    <div class="card-homepage shadow-sm rounded-4 text-center p-5 mx-auto" style="max-width: 640px;">
      <div class="mb-3">
        <i class="far fa-calendar-times fa-3x"></i>
      </div>
      <h3 class="h5 fw-bold mb-2">Aucun événement pour le moment</h3>
      <p class="mb-4">Créez votre premier événement pour le club MCNC.</p>
      <%= link_to new_admin_event_path, class: "btn-nxr d-inline-flex align-items-center" do %>
        <i class="fas fa-plus me-2"></i>Créer un événement
      <% end %>
    </div>
  <% end %>
</section>




<hr>

<h3>Les entraînements</h3>

<% if @trainings.empty? %>
  <p>Vous n'avez pas d'entraînement crée pour le moment</p>
<% else %>
  <ul>
    <% @trainings.each do |training| %>
      <li><%= training.name %>

          <%= link_to admin_training_path(training), class: "btn btn-primary", aria: { label: "Voir l'entraînement #{training.name}" } do %>
            <i class="fas fa-search"></i>
          <% end %>

          <%= link_to edit_admin_training_path(training),class: "btn btn-primary", aria: { label: "Modifier l'entraînement #{training.name}" } do %>
            <i class="fas fa-edit"></i>
          <% end %>

          <%= link_to admin_training_path(training),
            data: { turbo_method: :delete, turbo_confirm: "Es-tu sûr de vouloir supprimer cet entraînement ?" },
            class: "btn btn-danger",
            aria: { label: "Supprimer l'entraînement #{training.name}" } do %>
            <i class="fas fa-trash"></i>
          <% end %>
        </li>
    <% end %>
  </ul>
<% end %>

<%= link_to admin_trainings_path, class: "btn btn-primary", aria: { label: "Voir tous les entraînements" } do %>
  <i class="fas fa-search-plus"></i>
<% end %>

<%= link_to new_admin_training_path, class: "btn btn-primary", aria: { label: "Créer un nouvel entraînement" } do %>
<i class="fas fa-plus"></i>
<% end %>

<hr>

<h3>Les courses</h3>

<% if @races.empty? %>
  <p>Vous n'avez pas de course créée pour le moment</p>
<% else %>
  <ul>
    <% @races.each do |race| %>
      <li><%= race.name %>

          <%= link_to admin_race_path(race), class: "btn btn-primary", aria: { label: "Voir la course #{race.name}" } do %>
            <i class="fas fa-search"></i>
          <% end %>

          <%= link_to edit_admin_race_path(race),class: "btn btn-primary", aria: { label: "Modifier la course #{race.name}" } do %>
            <i class="fas fa-edit"></i>
          <% end %>

          <%= link_to admin_race_path(race),
            data: { turbo_method: :delete, turbo_confirm: "Es-tu sûr de vouloir supprimer cette course ?" },
            class: "btn btn-danger",
            aria: { label: "Supprimer la course #{race.name}" } do %>
            <i class="fas fa-trash"></i>
          <% end %>
        </li>
    <% end %>
  </ul>
<% end %>

<%= link_to admin_races_path, class: "btn btn-primary", aria: { label: "Voir toutes les courses" } do %>
  <i class="fas fa-search-plus"></i>
<% end %>

<%= link_to new_admin_race_path, class: "btn btn-primary", aria: { label: "Créer une nouvelle course" } do %>
<i class="fas fa-plus"></i>
<% end %>

<hr>

<h3>Les articles</h3>

<% if @articles.empty? %>
  <p>Vous n'avez pas d'article crée pour le moment</p>
<% else %>
  <ul>
    <% @articles.each do |article| %>
      <li><%= article.title %>

          <%= link_to admin_article_path(article), class: "btn btn-primary", aria: { label: "Voir l'article #{article.title}" } do %>
            <i class="fas fa-search"></i>
          <% end %>

          <%= link_to edit_admin_article_path(article),class: "btn btn-primary", aria: { label: "Modifier l'article #{article.title}" } do %>
            <i class="fas fa-edit"></i>
          <% end %>

          <%= link_to admin_article_path(article),
            data: { turbo_method: :delete, turbo_confirm: "Es-tu sûr de vouloir supprimer cet article ?" },
            class: "btn btn-danger",
            aria: { label: "Supprimer l'article #{article.title}" } do %>
            <i class="fas fa-trash"></i>
          <% end %>
        </li>
    <% end %>
  </ul>
<% end %>

<%= link_to admin_articles_path, class: "btn btn-primary", aria: { label: "Voir tous les articles" } do %>
  <i class="fas fa-search-plus"></i>
<% end %>

<%= link_to new_admin_article_path, class: "btn btn-primary", aria: { label: "Créer un nouvel article" } do %>
<i class="fas fa-plus"></i>
<% end %>

<hr>

<h3>Les galeries photos</h3>

<% if @galleries.empty? %>
  <p>Vous n'avez pas de galerie créée pour le moment</p>
<% else %>
  <ul>
    <% @galleries.each do |gallery| %>
      <li><%= gallery.title %>

          <%= link_to admin_gallery_path(gallery), class: "btn btn-primary", aria: { label: "Voir la galerie #{gallery.title}" } do %>
            <i class="fas fa-search"></i>
          <% end %>

          <%= link_to edit_admin_gallery_path(gallery),class: "btn btn-primary", aria: { label: "Modifier la galerie #{gallery.title}" } do %>
            <i class="fas fa-edit"></i>
          <% end %>

          <%= link_to admin_gallery_path(gallery),
            data: { turbo_method: :delete, turbo_confirm: "Es-tu sûr de vouloir supprimer cette galerie ?" },
            class: "btn btn-danger",
            aria: { label: "Supprimer la galerie #{gallery.title}" } do %>
            <i class="fas fa-trash"></i>
          <% end %>
        </li>
    <% end %>
  </ul>
<% end %>

<%= link_to admin_galleries_path, class: "btn btn-primary", aria: { label: "Voir toutes les galeries" } do %>
  <i class="fas fa-search-plus"></i>
<% end %>

<%= link_to new_admin_gallery_path, class: "btn btn-primary", aria: { label: "Créer une nouvelle galerie" } do %>
<i class="fas fa-plus"></i>
<% end %>

<hr>

<h3>Les membres</h3>

<% if @users.empty? %>
  <p>Vous n'avez pas de profil de membre inscrit sur le site</p>
<% else %>
  <ul>
    <% @users.each do |user| %>
      <li><%= user.last_name %> - <%= user.first_name %>

          <%= link_to admin_user_path(user), class: "btn btn-primary", aria: { label: "Voir les données personnelles de #{user.last_name} - #{user.first_name}" } do %>
            <i class="fas fa-search"></i>
          <% end %>

          <%= link_to edit_admin_user_path(user),class: "btn btn-primary", aria: { label: "Modifier les données personnelles de #{user.last_name} - #{user.first_name}" } do %>
            <i class="fas fa-edit"></i>
          <% end %>

          <%= link_to admin_user_path(user),
            data: { turbo_method: :delete, turbo_confirm: "Es-tu sûr de vouloir supprimer cet utilisateur ?" },
            class: "btn btn-danger",
            aria: { label: "Supprimer l'utilisateur #{user.last_name} - #{user.first_name}" } do %>
            <i class="fas fa-trash"></i>
          <% end %>
        </li>
    <% end %>
  </ul>
<% end %>

<%= link_to admin_users_path, class: "btn btn-primary", aria: { label: "Voir tous les utilisateurs" } do %>
  <i class="fas fa-search-plus"></i>
<% end %>

<hr>

<h3>Les inscriptions en cours</h3>

<% if @recent_registrations.empty? %>
  <p>Aucune inscription récente</p>
<% else %>
  <ul>
    <% @recent_registrations.each do |registration| %>
      <li>
        <%= registration.user.first_name %> - <%= registration.user.last_name %>
        s'est inscrit à :
        <strong><%= registration.registerable.name %></strong>
        le <%= l(registration.created_at, format: :short) %>

        <%= link_to polymorphic_path([:admin, registration.registerable, registration]),
                    class: "btn btn-sm btn-info",
                    aria: { label: "Voir l'inscription de #{registration.user.first_name} - #{registration.user.last_name}" } do %>
          <i class="fas fa-search"></i>
        <% end %>

        <%= link_to polymorphic_path([:admin, registration.registerable, registration]),
                    data: { turbo_method: :delete, turbo_confirm: "Supprimer cette inscription ?" },
                    class: "btn btn-sm btn-danger",
                    aria: { label: "Supprimer l'inscription de #{registration.user.first_name} - #{registration.user.last_name}" } do %>
          <i class="fas fa-trash"></i>
        <% end %>
      </li>
    <% end %>
  </ul>
<% end %>
