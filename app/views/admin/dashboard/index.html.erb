<!-- HERO cohérente avec la homepage -->
<section class="admin-hero banner-dashboard"
  style="background-image: linear-gradient(rgba(0,0,0,0.45), rgba(0,0,0,0.55)), url(<%= asset_path('banner_mcnc.jpeg') %>);">
  <div class="container py-5">
    <h1 class="display-5 fw-bold mb-1">Bonjour <%= current_user.first_name %></h1>
    <p class="lead mb-0">Bienvenue sur votre tableau de bord administrateur</p>
  </div>
</section>

<%# Trainings %>
<section class="container my-5">
  <% has_trainings = @trainings.present? %>

  <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4">
    <h2 class="section-title mb-0">
      <i class="fas fa-calendar-alt me-2"></i>Gestion des entraînements
    </h2>

      <% if has_trainings %>
        <div class="d-flex gap-2 flex-wrap">
          <%= link_to new_admin_training_path, class: "btn-nxr d-inline-flex align-items-center" do %>
            <i class="fas fa-plus me-2"></i> Créer un entraînement
          <% end %>

          <%= link_to admin_trainings_path, class: "btn-nxr-orange d-inline-flex align-items-center" do %>
          <i class="fas fa-list-ul me-2"></i> Voir tous les entraînements
          <% end %>
        </div>
      <% end %>
    </div>

  <% if has_trainings %>
    <div class="row g-4">
      <% @trainings.each do |training| %>
        <div class="col-sm-6 col-lg-4 mx-auto">
          <article class="card card-admin shadow-sm rounded-4 h-100 overflow-hidden">
            <!-- Media -->
            <div class="ratio ratio-4x3 bg-dark">
              <% if training.image.attached? %>
                <%= image_tag training.image, class: "card-img-top object-cover", alt: training.name %>
              <% else %>
                <%= image_tag "training_img.png", class: "card-img-top object-contain p-3", alt: training.name %>
              <% end %>
            </div>

            <!-- Body -->
            <div class="card-body d-flex flex-column">
              <div class="d-flex align-items-start justify-content-between mb-2">
                <h3 class="h6 fw-bold mb-0"><%= training.name %></h3>
                <% if training.respond_to?(:status) %>
                  <span class="badge rounded-pill <%= training.status == "published" ? "bg-success" : "bg-secondary" %>">
                    <%= training.status.capitalize %>
                  </span>
                <% end %>
              </div>

              <p class="text-tertiary small mb-3">
                <i class="far fa-clock me-1"></i>
                <%= l(training.date, format: "%d %B %Y") %>
              </p>

              <div class="mt-auto d-flex align-items-center justify-content-between">
                <%= link_to admin_training_path(training),
                      class: "stretched-link text-decoration-none text-color-primary small me-2" do %>
                  <i class="fas fa-arrow-right me-1"></i> Voir la fiche
                <% end %>

                <div class="btn-toolbar gap-2">
                  <%= link_to edit_admin_training_path(training),
                        class: "btn btn-icon btn-edit-orange",
                        title: "Modifier #{training.name}",
                        aria: { label: "Modifier l'événement #{training.name}" } do %>
                    <i class="fas fa-edit"></i>
                  <% end %>

                  <%= link_to admin_training_path(training),
                        data: { turbo_method: :delete, turbo_confirm: "Supprimer cet entraînement ?" },
                        class: "btn btn-icon btn-delete-red",
                        title: "Supprimer #{training.name}",
                        aria: { label: "Supprimer l'entraînement #{training.name}" } do %>
                    <i class="fas fa-trash"></i>
                  <% end %>
                </div>
              </div>
            </div>
          </article>
        </div>
      <% end %>
    </div>


  <% else %>
    <!-- Empty state -->
    <div class="card-homepage shadow-sm rounded-4 text-center p-5 mx-auto" style="max-width: 640px;">
      <div class="mb-3">
        <i class="far fa-calendar-times fa-3x"></i>
      </div>
      <h3 class="h5 fw-bold mb-2">Aucun entraînement pour le moment</h3>
      <p class="mb-4">Créez votre premier entraînement pour le club MCNC.</p>
      <%= link_to new_admin_training_path, class: "btn-nxr d-inline-flex align-items-center" do %>
        <i class="fas fa-plus me-2"></i>Créer un entraînement
      <% end %>
    </div>
  <% end %>
</section>

<%# Races %>

<section class="container my-5">
  <% has_races = @races.present? %>

  <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4">
    <h2 class="section-title mb-0">
      <i class="fas fa-calendar-alt me-2"></i>Gestion des courses
    </h2>

      <% if has_races %>
        <div class="d-flex gap-2 flex-wrap">
          <%= link_to new_admin_race_path, class: "btn-nxr d-inline-flex align-items-center" do %>
            <i class="fas fa-plus me-2"></i> Créer une course
          <% end %>

          <%= link_to admin_races_path, class: "btn-nxr-orange d-inline-flex align-items-center" do %>
          <i class="fas fa-list-ul me-2"></i> Voir toutes les courses
          <% end %>
        </div>
      <% end %>
    </div>

  <% if has_races %>
    <div class="row g-4">
      <% @races.each do |race| %>
        <div class="col-sm-6 col-lg-4 mx-auto">
          <article class="card card-admin shadow-sm rounded-4 h-100 overflow-hidden">
            <!-- Media -->
            <div class="ratio ratio-4x3 bg-dark">
              <% if race.image.attached? %>
                <%= image_tag race.image, class: "card-img-top object-cover", alt: race.name %>
              <% else %>
                <%= image_tag "race_flag.png", class: "card-img-top object-contain p-3", alt: race.name %>
              <% end %>
            </div>

            <!-- Body -->
            <div class="card-body d-flex flex-column">
              <div class="d-flex align-items-start justify-content-between mb-2">
                <h3 class="h6 fw-bold mb-0"><%= race.name %></h3>
                <% if race.respond_to?(:status) %>
                  <span class="badge rounded-pill <%= race.status == "published" ? "bg-success" : "bg-secondary" %>">
                    <%= race.status.capitalize %>
                  </span>
                <% end %>
              </div>

              <p class="text-tertiary small mb-3">
                <i class="far fa-clock me-1"></i>
                <%= l(race.date, format: "%d %B %Y") %>
              </p>

              <div class="mt-auto d-flex align-items-center justify-content-between">
                <%= link_to admin_race_path(race),
                      class: "stretched-link text-decoration-none text-color-primary small me-2" do %>
                  <i class="fas fa-arrow-right me-1"></i> Voir la fiche
                <% end %>

                <div class="btn-toolbar gap-2">
                  <%= link_to edit_admin_race_path(race),
                        class: "btn btn-icon btn-edit-orange",
                        title: "Modifier #{race.name}",
                        aria: { label: "Modifier la course #{race.name}" } do %>
                    <i class="fas fa-edit"></i>
                  <% end %>

                  <%= link_to admin_race_path(race),
                        data: { turbo_method: :delete, turbo_confirm: "Supprimer cette course ?" },
                        class: "btn btn-icon btn-delete-red",
                        title: "Supprimer #{race.name}",
                        aria: { label: "Supprimer la course #{race.name}" } do %>
                    <i class="fas fa-trash"></i>
                  <% end %>
                </div>
              </div>
            </div>
          </article>
        </div>
      <% end %>
    </div>

  <% else %>
    <!-- Empty state -->
    <div class="card-homepage shadow-sm rounded-4 text-center p-5 mx-auto" style="max-width: 640px;">
      <div class="mb-3">
        <i class="far fa-calendar-times fa-3x"></i>
      </div>
      <h3 class="h5 fw-bold mb-2">Aucune course pour le moment</h3>
      <p class="mb-4">Créez votre première course pour le club MCNC.</p>
      <%= link_to new_admin_race_path, class: "btn-nxr d-inline-flex align-items-center" do %>
        <i class="fas fa-plus me-2"></i>Créer une course
      <% end %>
    </div>
  <% end %>
</section>

<%# Events %>

<section class="container my-5">
  <% has_events = @events.present? %>


  <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4">
    <h2 class="section-title mb-0">
      <i class="fas fa-calendar-alt me-2"></i>Gestion des événements
    </h2>

      <% if has_events %>
        <div class="d-flex gap-2 flex-wrap">
          <%= link_to new_admin_event_path, class: "btn-nxr d-inline-flex align-items-center" do %>
            <i class="fas fa-plus me-2"></i> Créer un événement
          <% end %>

          <%= link_to admin_events_path, class: "btn-nxr-orange d-inline-flex align-items-center" do %>
          <i class="fas fa-list-ul me-2"></i> Voir tous les événements
          <% end %>
        </div>
      <% end %>
    </div>

  <% if has_events %>
    <div class="row g-4">
      <% @events.each do |event| %>
        <div class="col-sm-6 col-lg-4 mx-auto">
          <article class="card card-admin shadow-sm rounded-4 h-100 overflow-hidden">
            <!-- Media -->
            <div class="ratio ratio-4x3 bg-dark">
              <% if event.image.attached? %>
                <%= image_tag event.image, class: "card-img-top object-cover", alt: event.name %>
              <% else %>
                <%= image_tag "logo_mcnc_3.png", class: "card-img-top object-contain p-3", alt: event.name %>
              <% end %>
            </div>

            <!-- Body -->
            <div class="card-body d-flex flex-column">
              <div class="d-flex align-items-start justify-content-between mb-2">
                <h3 class="h6 fw-bold mb-0"><%= event.name %></h3>
                <% if event.respond_to?(:status) %>
                  <span class="badge rounded-pill <%= event.status == "published" ? "bg-success" : "bg-secondary" %>">
                    <%= event.status.capitalize %>
                  </span>
                <% end %>
              </div>

              <p class="text-tertiary small mb-3">
                <i class="far fa-clock me-1"></i>
                <%= l(event.date, format: "%d %B %Y") %>
              </p>

              <div class="mt-auto d-flex align-items-center justify-content-between">
                <%= link_to admin_event_path(event),
                      class: "stretched-link text-decoration-none text-color-primary small me-2" do %>
                  <i class="fas fa-arrow-right me-1"></i> Voir la fiche
                <% end %>

                <div class="btn-toolbar gap-2">
                  <%= link_to edit_admin_event_path(event),
                        class: "btn btn-icon btn-edit-orange",
                        title: "Modifier #{event.name}",
                        aria: { label: "Modifier l'événement #{event.name}" } do %>
                    <i class="fas fa-edit"></i>
                  <% end %>

                  <%= link_to admin_event_path(event),
                        data: { turbo_method: :delete, turbo_confirm: "Supprimer cet événement ?" },
                        class: "btn btn-icon btn-delete-red",
                        title: "Supprimer #{event.name}",
                        aria: { label: "Supprimer l'événement #{event.name}" } do %>
                    <i class="fas fa-trash"></i>
                  <% end %>
                </div>
              </div>
            </div>
          </article>
        </div>
      <% end %>
    </div>

  <% else %>
    <!-- Empty state -->
    <div class="card-homepage shadow-sm rounded-4 text-center p-5 mx-auto" style="max-width: 640px;">
      <div class="mb-3">
        <i class="far fa-calendar-times fa-3x"></i>
      </div>
      <h3 class="h5 fw-bold mb-2">Aucun événement pour le moment</h3>
      <p class="mb-4">Créez votre premier événement pour le club MCNC.</p>
      <%= link_to new_admin_event_path, class: "btn-nxr d-inline-flex align-items-center" do %>
        <i class="fas fa-plus me-2"></i>Créer un événement
      <% end %>
    </div>
  <% end %>
</section>

<%# Les News %>

<section class="container my-5">
  <% has_articles = @articles.present? %>

  <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4">
    <h2 class="section-title mb-0">
      <i class="fas fa-calendar-alt me-2"></i>Gestion des articles
    </h2>

      <% if has_articles %>
        <div class="d-flex gap-2 flex-wrap">
          <%= link_to new_admin_race_path, class: "btn-nxr d-inline-flex align-items-center" do %>
            <i class="fas fa-plus me-2"></i> Créer un article
          <% end %>

          <%= link_to admin_articles_path, class: "btn-nxr-orange d-inline-flex align-items-center" do %>
          <i class="fas fa-list-ul me-2"></i> Voir tous les articles
          <% end %>
        </div>
      <% end %>
    </div>

  <% if has_articles %>
    <div class="row g-4">
      <% @articles.each do |article| %>
        <div class="col-sm-6 col-lg-4 mx-auto">
          <article class="card card-admin shadow-sm rounded-4 h-100 overflow-hidden">
            <!-- Media -->
            <div class="ratio ratio-4x3 bg-dark">
              <% if article.image.attached? %>
                <%= image_tag article.image, class: "card-img-top object-cover", alt: article.title %>
              <% else %>
                <%= image_tag "logo_mcnc_3.png", class: "card-img-top object-contain p-3", alt: article.title %>
              <% end %>
            </div>

            <!-- Body -->
            <div class="card-body d-flex flex-column">
              <div class="d-flex align-items-start justify-content-between mb-2">
                <h3 class="h6 fw-bold mb-0"><%= article.title %></h3>
                <% if article.respond_to?(:status) %>
                  <span class="badge rounded-pill <%= article.status == "published" ? "bg-success" : "bg-secondary" %>">
                    <%= article.status.capitalize %>
                  </span>
                <% end %>
              </div>

              <p class="text-tertiary small mb-3">
                <i class="far fa-clock me-1"></i>
                <%= l(article.date, format: "%d %B %Y") %>
              </p>

              <div class="mt-auto d-flex align-items-center justify-content-between">
                <%= link_to admin_article_path(article),
                      class: "stretched-link text-decoration-none text-color-primary small me-2" do %>
                  <i class="fas fa-arrow-right me-1"></i> Voir l'article
                <% end %>

                <div class="btn-toolbar gap-2">
                  <%= link_to edit_admin_article_path(article),
                        class: "btn btn-icon btn-edit-orange",
                        title: "Modifier #{article.title}",
                        aria: { label: "Modifier l'article' #{article.title}" } do %>
                    <i class="fas fa-edit"></i>
                  <% end %>

                  <%= link_to admin_article_path(article),
                        data: { turbo_method: :delete, turbo_confirm: "Supprimer cet article ?" },
                        class: "btn btn-icon btn-delete-red",
                        title: "Supprimer #{article.title}",
                        aria: { label: "Supprimer l'article' #{article.title}" } do %>
                    <i class="fas fa-trash"></i>
                  <% end %>
                </div>
              </div>
            </div>
          </article>
        </div>
      <% end %>
    </div>

  <% else %>
    <!-- Empty state -->
    <div class="card-homepage shadow-sm rounded-4 text-center p-5 mx-auto" style="max-width: 640px;">
      <div class="mb-3">
        <i class="far fa-calendar-times fa-3x"></i>
      </div>
      <h3 class="h5 fw-bold mb-2">Aucun article pour le moment</h3>
      <p class="mb-4">Créez votre premier article pour le club MCNC.</p>
      <%= link_to new_admin_article_path, class: "btn-nxr d-inline-flex align-items-center" do %>
        <i class="fas fa-plus me-2"></i>Créer un article
      <% end %>
    </div>
  <% end %>
</section>

<%# Galleries %>

<section class="container my-5">
  <% has_galleries = @galleries.present? %>

  <div class="d-flex flex-column flex-md-row align-items-md-center justify-content-between gap-3 mb-4">
    <h2 class="section-title mb-0">
      <i class="fas fa-calendar-alt me-2"></i>Gestion des albums photo
    </h2>

      <% if has_galleries %>
        <div class="d-flex gap-2 flex-wrap">
          <%= link_to new_admin_gallery_path, class: "btn-nxr d-inline-flex align-items-center" do %>
            <i class="fas fa-plus me-2"></i> Créer un nouvel album
          <% end %>

          <%= link_to admin_galleries_path, class: "btn-nxr-orange d-inline-flex align-items-center" do %>
          <i class="fas fa-list-ul me-2"></i> Voir tous les albums
          <% end %>
        </div>
      <% end %>
    </div>

  <% if has_galleries %>
    <div class="row g-4">
      <% @galleries.each do |gallery| %>
        <div class="col-sm-6 col-lg-4 mx-auto">
          <article class="card card-admin shadow-sm rounded-4 h-100 overflow-hidden">
            <!-- Media -->
            <div class="ratio ratio-4x3 bg-dark">
              <% if gallery.images.attached? %>
                <%= image_tag gallery.images.first, class: "card-img-top object-cover", alt: gallery.title %>
              <% else %>
                <%= image_tag "logo_mcnc_3.png", class: "card-img-top object-contain p-3", alt: gallery.title %>
              <% end %>
            </div>

            <!-- Body -->
            <div class="card-body d-flex flex-column">
              <div class="d-flex align-items-start justify-content-between mb-2">
                <h3 class="h6 fw-bold mb-0"><%= gallery.title %></h3>
                <% if gallery.respond_to?(:status) %>
                  <span class="badge rounded-pill <%= gallery.status == "published" ? "bg-success" : "bg-secondary" %>">
                    <%= gallery.status.capitalize %>
                  </span>
                <% end %>
              </div>

              <p class="text-tertiary small mb-3">
                <i class="far fa-clock me-1"></i>
                <%= l(gallery.date, format: "%d %B %Y") %>
              </p>

              <div class="mt-auto d-flex align-items-center justify-content-between">
                <%= link_to admin_gallery_path(gallery),
                      class: "stretched-link text-decoration-none text-color-primary small me-2" do %>
                  <i class="fas fa-arrow-right me-1"></i> Voir l'album photo
                <% end %>

                <div class="btn-toolbar gap-2">
                  <%= link_to edit_admin_gallery_path(gallery),
                        class: "btn btn-icon btn-edit-orange",
                        title: "Modifier #{gallery.title}",
                        aria: { label: "Modifier l'album photo' #{gallery.title}" } do %>
                    <i class="fas fa-edit"></i>
                  <% end %>

                  <%= link_to admin_gallery_path(gallery),
                        data: { turbo_method: :delete, turbo_confirm: "Supprimer cet album photo ?" },
                        class: "btn btn-icon btn-delete-red",
                        title: "Supprimer #{gallery.title}",
                        aria: { label: "Supprimer l'album photo' #{gallery.title}" } do %>
                    <i class="fas fa-trash"></i>
                  <% end %>
                </div>
              </div>
            </div>
          </article>
        </div>
      <% end %>
    </div>

  <% else %>
    <!-- Empty state -->
    <div class="card-homepage shadow-sm rounded-4 text-center p-5 mx-auto" style="max-width: 640px;">
      <div class="mb-3">
        <i class="far fa-calendar-times fa-3x"></i>
      </div>
      <h3 class="h5 fw-bold mb-2">Aucun album photo pour le moment</h3>
      <p class="mb-4">Créez votre premier album photo pour le club MCNC.</p>
      <%= link_to new_admin_gallery_path, class: "btn-nxr d-inline-flex align-items-center" do %>
        <i class="fas fa-plus me-2"></i>Créer un album photo
      <% end %>
    </div>
  <% end %>
</section>


<hr>

<h3>Les membres</h3>

<% if @users.empty? %>
  <p>Vous n'avez pas de profil de membre inscrit sur le site</p>
<% else %>
  <ul>
    <% @users.each do |user| %>
      <li><%= user.last_name %> - <%= user.first_name %>

          <%= link_to admin_user_path(user), class: "btn btn-primary", aria: { label: "Voir les données personnelles de #{user.last_name} - #{user.first_name}" } do %>
            <i class="fas fa-search"></i>
          <% end %>

          <%= link_to edit_admin_user_path(user),class: "btn btn-primary", aria: { label: "Modifier les données personnelles de #{user.last_name} - #{user.first_name}" } do %>
            <i class="fas fa-edit"></i>
          <% end %>

          <%= link_to admin_user_path(user),
            data: { turbo_method: :delete, turbo_confirm: "Es-tu sûr de vouloir supprimer cet utilisateur ?" },
            class: "btn btn-danger",
            aria: { label: "Supprimer l'utilisateur #{user.last_name} - #{user.first_name}" } do %>
            <i class="fas fa-trash"></i>
          <% end %>
        </li>
    <% end %>
  </ul>
<% end %>

<%= link_to admin_users_path, class: "btn btn-primary", aria: { label: "Voir tous les utilisateurs" } do %>
  <i class="fas fa-search-plus"></i>
<% end %>

<hr>

<h3>Les inscriptions en cours</h3>

<% if @recent_registrations.empty? %>
  <p>Aucune inscription récente</p>
<% else %>
  <ul>
    <% @recent_registrations.each do |registration| %>
      <li>
        <%= registration.user.first_name %> - <%= registration.user.last_name %>
        s'est inscrit à :
        <strong><%= registration.registerable.name %></strong>
        le <%= l(registration.created_at, format: :short) %>

        <%= link_to polymorphic_path([:admin, registration.registerable, registration]),
                    class: "btn btn-sm btn-info",
                    aria: { label: "Voir l'inscription de #{registration.user.first_name} - #{registration.user.last_name}" } do %>
          <i class="fas fa-search"></i>
        <% end %>

        <%= link_to polymorphic_path([:admin, registration.registerable, registration]),
                    data: { turbo_method: :delete, turbo_confirm: "Supprimer cette inscription ?" },
                    class: "btn btn-sm btn-danger",
                    aria: { label: "Supprimer l'inscription de #{registration.user.first_name} - #{registration.user.last_name}" } do %>
          <i class="fas fa-trash"></i>
        <% end %>
      </li>
    <% end %>
  </ul>
<% end %>
