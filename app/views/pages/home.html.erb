<div class="banner-hp" style="background-image: linear-gradient(rgba(0,0,0,0.4),rgba(0,0,0,0.4)), url(https://cdn.pixabay.com/photo/2023/10/18/22/48/ai-generated-8325216_1280.png);">
  <div class="container">
    <h1>Rejoignez le <strong>club</strong> MCNC<strong></h1>
    <p>L'aventure commence ici ...</p>
    <div class= "mt-4">
      <%= link_to "Créer un compte", new_user_registration_path, class: "btn-nxr" %>
      <%= link_to "En savoir plus", new_user_session_path, class: "btn-nxr-orange" %>
    </div>
  </div>
</div>

<div class="container my-5">
  <h2 class="mb-4 text-center">Les événements à venir</h2>

  <div class="row g-3">
    <% @upcoming_activities.each do |activity| %>
      <div class="col-md-6 col-lg-4">
        <div class="card-homepage shadow-sm rounded-4 h-100">
          <div class="row g-0 h-100">

            <!-- Image -->
            <div class="col-5 d-flex align-items-center justify-content-center p-2">
  <% if activity.respond_to?(:image) && activity.image.attached? %>
    <%= image_tag activity.image, class: "img-fluid rounded-start", alt: activity.name, class: "img-card-hp" %>
  <% else %>
    <% default_image =
      case activity.type
      when "Race"
        "race_flag.png"      # image pour les courses
      when "Training"
        "training_png.png"  # image pour les entraînements
      when "Event"
        "logo_nxr.png"     # image pour les événements
      else
        "logo_nxr.png"          # fallback si aucun type reconnu
      end
    %>

    <%= image_tag default_image, class: "img-fluid rounded-start", alt: activity.name, style: "max-height: 120px; object-fit: contain;" %>
  <% end %>
</div>


            <!-- Infos -->
            <div class="col-7 mt-2">
              <div class="card-body d-flex flex-column h-100">
                <h6 class="card-title mb-1"><%= activity.name %></h6>
                <small class="mb-2"><%= l(activity.date, format: "%d %B %Y") %></small>

                <div class="mt-4 d-flex gap-2">
                  <% # Bouton Voir %>
                  <% view_path = case activity.type
                                when "Race" then public_race_path(activity.id)
                                when "Event" then public_event_path(activity.id)
                                when "Training" then public_training_path(activity.id)
                                end %>
                  <%= link_to "Voir", view_path, class: "btn-nxr-hp-reverse-green" %>

                  <% # Bouton S'inscrire %>
                  <% if user_signed_in? && current_user.member? %>
                    <% register_path = case activity.type
                                      when "Race" then new_members_race_registration_path(activity.id)
                                      when "Event" then new_members_event_registration_path(activity.id)
                                      when "Training" then new_members_training_registration_path(activity.id)
                                      end %>
                    <%= link_to "S'inscrire", register_path, class: "btn-nxr-hp-reverse-orange" %>
                  <% else %>
                    <%= link_to "S'inscrire", new_user_session_path, class: "btn-nxr-hp-reverse-orange" %>
                  <% end %>
                </div>

              </div>
            </div>

          </div>
        </div>
      </div>
    <% end %>
  </div>
</div>
